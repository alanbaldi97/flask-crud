(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"1f54":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",[a("div",{staticClass:"row"},[a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("q-breadcrumbs",{attrs:{gutter:"none"}},[a("q-breadcrumbs-el",{attrs:{label:"Administradores",to:{name:"managers"}}}),a("q-breadcrumbs-el",{attrs:{label:"Agregar Administrador"}})],1)],1)]),a("div",{staticClass:"row q-pa-md justify-center"},[a("div",{staticClass:"col-md-7"},[a("div",{staticClass:"row justify-center"},[a("div",{staticClass:"col-md-12"},[a("q-card",[a("q-card-section",[a("div",{staticClass:"row justify-center"},[a("cropper",{attrs:{src:t.img,disable:t.isVisibility},on:{result:t.onResult}})],1)]),a("q-card-section",[a("q-form",{ref:"form"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("q-input",{attrs:{dense:"",outlined:"",placeholder:"Nombre(s)",rules:[t.rules.required],disable:t.isVisibility},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),a("div",{staticClass:"col-md-12 q-mt-sm"},[a("q-input",{attrs:{dense:"",outlined:"",placeholder:"Apellido(s)",rules:[t.rules.required],disable:t.isVisibility},model:{value:t.last_name,callback:function(e){t.last_name=e},expression:"last_name"}})],1),a("div",{staticClass:"col-md-12 q-mt-sm"},[a("q-input",{attrs:{dense:"",outlined:"",placeholder:"Correo Electrónico",rules:[t.rules.required,t.rules.email],disable:t.isVisibility},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),a("div",{staticClass:"col-md-12 q-mt-sm"},[a("q-select",{attrs:{"option-value":"id","option-label":"name",dense:"",outlined:"",options:t.areaTypes,label:"Tipo de Area",rules:[t.rules.required],"emit-value":"","map-options":"",disable:t.isVisibility},model:{value:t.area_type_id,callback:function(e){t.area_type_id=e},expression:"area_type_id"}})],1),a("div",{staticClass:"col-md-12 q-mt-sm"},[a("q-select",{attrs:{dense:"",outlined:"",options:["Activo","Inactivo"],label:"Estatus",rules:[t.rules.required],disable:t.isVisibility},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}})],1)]),a("div",{staticClass:"row justify-center"},[a("q-btn",{attrs:{outline:"",size:"md",color:"secondary"},on:{click:function(e){return t.$router.push({name:"managers"})}}},[t._v("Cancelar")]),t.isVisibility?t._e():a("q-btn",{staticClass:"q-ml-sm",attrs:{size:"md",color:"indigo-7"},on:{click:t.save}},[t._v("\n                                        "+t._s(t.isEdit?"Editar":"Agregar")+" Administrador\n                                    ")])],1)])],1)],1)],1)])])])])},i=[],r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"q-pa-md q-gutter-sm"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.onLoad,expression:"onLoad"}]},[a("vue-croppie",{ref:"croppie",attrs:{enableOrientation:!0,boundary:{width:150,height:150}}}),a("div",{staticClass:"row justify-center"},[a("q-btn",{staticClass:"text-weight-bolder",attrs:{color:"indigo-5",size:"sm"},on:{click:t.onCrop}},[t._v("Cortar")])],1)],1),t.onLoad?t._e():[a("q-avatar",{attrs:{size:"150px"}},[a("img",{attrs:{src:t.getSource}})]),a("div",{staticClass:"row justify-center"},[a("q-btn",{staticClass:"text-weight-bolder",attrs:{disable:t.disable,color:"indigo-5",size:"sm"},on:{click:t.openFileManager}},[t._v("Seleccionar imagen")])],1)]],2)},n=[],l=(a("ddb0"),a("2b3d"),a("9861"),{props:{src:{type:String,default:null},disable:{type:Boolean,default:!1}},data(){return{onLoad:!1,source:this.src,cropped:null}},computed:{getSource(){return this.source||"https://cdn.quasar.dev/img/avatar.png"}},watch:{src(){this.source=this.src}},methods:{openFileManager(){let t=document.createElement("input");t.type="file",t.accept="image/*",t.onchange=t=>{const e=t.target.files[0];this.source=URL.createObjectURL(e),this.$refs.croppie.bind({url:this.source}),this.onLoad=!0},t.click()},async onCrop(){let t={format:"png",circle:!0};const e=await this.$refs.croppie.result(t),a=await fetch(e),s=await a.blob(),i=`image_${+new Date}.${t.format}`,r=new File([s],i,{type:"image/png"});this.source=URL.createObjectURL(r),this.onLoad=!1,this.$emit("result",r)}}}),o=l,c=a("2877"),d=a("9c40"),u=a("cb32"),m=a("eebe"),p=a.n(m),h=Object(c["a"])(o,r,n,!1,null,null,null),g=h.exports;p()(h,"components",{QBtn:d["a"],QAvatar:u["a"]});var b=a("e78e"),f=a("bc3e"),y=a("3042"),v=a("2f62");const w=new b["a"],q=new f["a"];var _={components:{Cropper:g},created(){this.load(),console.log(this.isVisibility)},data(){return{image:null,id:null,name:null,last_name:null,img:null,email:null,area:null,area_type_id:null,status:null,rules:{required:y["b"],email:y["a"]},areaTypes:[]}},computed:{...Object(v["c"])("manager",{isEdit:t=>t.isEdit,isVisibility:t=>t.isVisibility})},methods:{async load(){this.$q.loading.show(),await this.loadAreaTypes(),await this.loadData(),this.$q.loading.hide()},async loadData(){try{if(!this.isEdit)return;const{id:t}=this.$route.params,{manager:e}=await q.getById(t);if(!e)return;this.id=e.id,this.name=e.name,this.last_name=e.last_name,this.email=e.email,this.area_type_id=e.area_type_id,this.status=e.status,this.img=e.img?`https://test-flask-crud.herokuapp.com/api/managers/get-image?filename=${e.img}`:null}catch(t){console.log(t)}},async loadAreaTypes(){const{data:t}=await w.getAll();this.areaTypes=t},onResult(t){this.image=t},async save(){if(!this.image&&!this.isEdit)return this.$notify("Debe seleccionar una image","error");const t=await this.$refs.form.validate();if(t)try{this.$q.loading.show();const t=new FormData;this.image&&t.append("image",this.image),t.append("name",this.name),t.append("last_name",this.last_name),t.append("email",this.email),t.append("area_type_id",this.area_type_id),t.append("status",this.status);const e=this.isEdit?await q.update(this.id,t):await q.insert(t);if(!e.success)return this.$notify(e.msg,"error");this.$notify(e.msg),this.$router.push({name:"managers"})}catch(e){this.$notify("Lo sentimos ocurrio un error","error")}finally{this.$q.loading.hide()}}}},C=_,$=a("9989"),k=a("ead5"),A=a("079e"),x=a("f09f"),E=a("a370"),j=a("0378"),L=a("27f9"),Q=a("ddd8"),V=Object(c["a"])(C,s,i,!1,null,null,null);e["default"]=V.exports;p()(V,"components",{QPage:$["a"],QBreadcrumbs:k["a"],QBreadcrumbsEl:A["a"],QCard:x["a"],QCardSection:E["a"],QForm:j["a"],QInput:L["a"],QSelect:Q["a"],QBtn:d["a"]})},3042:function(t,e,a){"use strict";a.d(e,"b",(function(){return s})),a.d(e,"a",(function(){return i}));const s=t=>null!=t&&""!=t||"Campo requerido",i=t=>0==(t||"").length||(/.+@.+\..+/.test(t)||"Correo no válido")},bc3e:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var s=a("5607");class i extends s["a"]{constructor(){super()}async getAll(t={}){const{data:e}=await this.post("managers",t);return e}async getById(t){const{data:e}=await this.get(`managers/${t}/get-by-id`);return e}async insert(t){const{data:e}=await this.post("managers/store",t);return e}async update(t,e){const{data:a}=await this.post(`managers/${t}`,e);return a}async deleteManager(t){const{data:e}=await this.delete(`managers/${t}`);return e}}},e78e:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var s=a("5607");class i extends s["a"]{constructor(){super()}getAll(){return this.get("area-types")}}}}]);